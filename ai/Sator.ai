globals
    constant integer TENET_PIONEER            = 'h005'
    constant integer TENET_FACTORY            = 'h001'
    constant integer TENET_BARRACKS           = 'h00K'
    constant integer TENET_CONTAINER          = 'h004'
	
	constant integer RUINED_BUILDING_1        = 'o000'
	constant integer RUINED_BUILDING_2        = 'o001'
	
	constant integer MACHINE_GUN_TURRET       = 'h00G'
	constant integer FLAMETHROWER_TURRET      = 'h00F'
	constant integer ANTI_AIR_TURRET          = 'h00E'
	
	constant integer UPG_MINE_DETECTOR        = 'R000'
	constant integer UPG_MEDIC                = 'R001'
	constant integer UPG_ENGINEER             = 'R002'
	constant integer UPG_MINES                = 'R005'
	constant integer UPG_ROCKET_LAUNCHER      = 'R003'
	constant integer UPG_STINGER              = 'R004'
	constant integer UPG_IMPROVED_DEFENCE     = 'R007'
	
    constant integer SATOR_MERCENARY          = 'z002'
    constant integer HERO_VOLKOV              = 'H00D'
	
	constant integer PLACE_C4                 = 'A01C'
endglobals

function ChooseHeroSkill takes nothing returns integer
    local integer curHero = GetHeroId()
    local integer level = GetHeroLevelAI()

    if (curHero == HERO_VOLKOV) then
        //if (level == 6) then
            //return SUMMON_PHOENIX
        //elseif (mod == 0) then
            //return PLACE_C4
        //endif
    endif

    return 'Aamk'
endfunction

function InitHero takes nothing returns nothing
	if (GetUnitCountDone(HERO_VOLKOV) > 0) then
		set hero_id = HERO_VOLKOV
    endif
endfunction

//function AlgorithmFilter takes nothing returns boolean
    //return ( GetItemTypeId(GetFilterItem()) == 'I000' )
//endfunction

//function GetAlgorithm takes nothing returns item
//	return RandomItemInRectBJ(GetPlayableMapRect(), Condition(function AlgorithmFilter))
//endfunction

function UpdateWorkers takes nothing returns nothing
	loop
		call SetGoldPeons(5)
		call SetWoodPeons(0)
		//call AddGuardPost(SATOR_MERCENARY, GetItemX(GetAlgorithm()), GetItemY(GetAlgorithm()))
		//call AddGuardPost(hero_id, GetItemX(GetAlgorithm()), GetItemY(GetAlgorithm()))
		call Sleep(1)
	endloop
endfunction

function ConfigureAI takes nothing returns nothing
    call SetTargetHeroes( true )
    call SetUnitsFlee( true )
    call SetHeroesFlee( true )
    call SetPeonsRepair( true )
    call SetHeroesBuyItems( true )
    call SetHeroesTakeItems( false )
    call SetSlowChopping( false )
	call SetWatchMegaTargets( true )
	call SetIgnoreInjured( false )
	call SetGroupsFlee( true )
	//call SetCaptainChanges ( true )
	call SetSmartArtillery ( true )
endfunction

function BuildingStrategy takes nothing returns nothing
    // **********************************
    // *      Building Strategy         *
    // **********************************
    // Tier 1 Buildings
    call SetReplacements( 1, 2, 3 )
    call SetBuildUnit( 1, TENET_CONTAINER )
    call SetBuildUnit( 6, TENET_PIONEER )
    call SetBuildUnit( 1, TENET_BARRACKS )
    call SetBuildUnit( 1, TENET_FACTORY )
	//call SetBuildUnit( 1, RUINED_BUILDING_1 )
	//call SetBuildUnit( 1, RUINED_BUILDING_2 )
	
	call SetBuildUpgr( 1, UPG_MEDIC )
	call SetBuildUpgr( 1, UPG_ENGINEER )
	call SetBuildUpgr( 1, UPG_MINES )
	call SetBuildUpgr( 1, UPG_ROCKET_LAUNCHER )
	call SetBuildUpgr( 1, UPG_STINGER )
	call SetBuildUpgr( 1, UPG_MINE_DETECTOR )
	call SetBuildUpgr( 3, UPG_IMPROVED_DEFENCE )
	
	call SetBuildUnit( 6, MACHINE_GUN_TURRET )
	call SetBuildUnit( 4, FLAMETHROWER_TURRET )
	call SetBuildUnit( 2, ANTI_AIR_TURRET )
	
    call CampaignDefenderEx( 6, 6, 6, SATOR_MERCENARY )
	call CampaignDefender( 0, 1, hero_id )
	
    // **********************************
    // *    End Building Strategy       *
    // **********************************
endfunction


function main takes nothing returns nothing
    call CampaignAI( null, function ChooseHeroSkill )
    call ConfigureAI( )
    call InitHero( )
	call StartThread(function UpdateWorkers)

    call BuildingStrategy( )
endfunction